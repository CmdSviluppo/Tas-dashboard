<div class="profile-create-page">
  <div class="page-header">
    <h1>Create New Profile</h1>
  </div>

  <nb-card>
    <nb-card-body>
      <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <!-- Name -->
        <div class="form-group">
          <label class="label">Name *</label>
          <input
            nbInput
            fullWidth
            formControlName="name"
            placeholder="e.g., Aggressive Momentum"
            [status]="getFieldStatus('name')">
          <span class="caption status-danger" *ngIf="isFieldInvalid('name')">
            {{ getFieldError('name') }}
          </span>
        </div>

        <!-- Code (auto-generated with manual override) -->
        <div class="form-group">
          <label class="label">Code *</label>
          <div class="code-input-group">
            <input
              nbInput
              fullWidth
              formControlName="code"
              placeholder="AUTO_GENERATED"
              [status]="getFieldStatus('code')">
            <button
              nbButton
              type="button"
              status="basic"
              size="small"
              (click)="generateCode()">
              <nb-icon icon="sync-outline"></nb-icon>
              Auto-Generate
            </button>
          </div>
          <span class="caption">
            Uppercase letters, numbers, and underscores only. Auto-generated from name.
          </span>
          <span class="caption status-danger" *ngIf="isFieldInvalid('code')">
            {{ getFieldError('code') }}
          </span>
        </div>

        <!-- Description -->
        <div class="form-group">
          <label class="label">Description</label>
          <textarea
            nbInput
            fullWidth
            formControlName="description"
            placeholder="Optional description..."
            rows="3">
          </textarea>
        </div>

        <!-- Market Regime -->
        <div class="form-group">
          <label class="label">Target Market Regime</label>
          <nb-select fullWidth formControlName="marketRegime">
            <nb-option [value]="null">None (All Markets)</nb-option>
            <nb-option *ngFor="let regime of regimes" [value]="regime">
              {{ getRegimeLabel(regime) }}
            </nb-option>
          </nb-select>
          <span class="caption">
            Optional: Optimize this profile for a specific market condition
          </span>
        </div>

        <!-- Actions -->
        <div class="form-actions">
          <button
            nbButton
            type="button"
            status="basic"
            (click)="cancel()">
            Cancel
          </button>
          <button
            nbButton
            type="submit"
            status="primary"
            [disabled]="form.invalid || submitting()">
            <nb-spinner *ngIf="submitting()" size="tiny" status="control"></nb-spinner>
            {{ submitting() ? 'Creating...' : 'Create Profile' }}
          </button>
        </div>
      </form>
    </nb-card-body>
  </nb-card>
</div>
